!function(s,r){"use strict";r.utilites.namespace("cherrySearch"),r.cherrySearch={settings:{searchFormWrapperClass:".cherry-search",searchFormClass:".cherry-search__form",inputClass:".cherry-search__field",submitClass:".cherry-search__submit",listClass:".cherry-search__results-list",itemClass:".cherry-search__results-item",messageHolder:".cherry-search__message",spinner:".cherry-search__spinner",moreButton:".cherry-search__more-button",searchHandlerId:"cherry_search_public_action"},init:function(){s("body").on("focus"+this.settings.searchFormWrapperClass,this.settings.inputClass,this.initCherrySearch.bind(this))},initCherrySearch:function(r){var e=s(r.target).closest(this.settings.searchFormWrapperClass);e.cherrySearch(this.settings)}},r.cherrySearch.init(),s.fn.cherrySearch=function(e){var a=this[0];if(a.isInit)return"is init: true";var t=e,c=cherrySearchMessages,o=null,n=wp.template("search-form-results-item"),i=s(t.listClass,a),h=s(t.messageHolder,i),l=s(t.spinner,i);a.isInit=!0,a.inputChangeHandler=function(r){var e=r.target.value;s("ul",i).html(""),a.outputMessage("",""),e?(a.showList(),l.addClass("show"),clearTimeout(o),o=setTimeout(function(){a.searchAjaxInstancer.sendData(e)},450)):a.hideList()},a.successCallback=function(r){if("error-notice"!==r.type){var e=r.data,t=e.error,o=e.message,u=e.posts,m=null,C="";if(0===e.post_count||t)a.outputMessage(o,"show");else{h.removeClass("show");for(m in u)C+="more_button"===m?u[m]:n(u[m])}l.removeClass("show"),s("ul",i).html(C)}else a.outputMessage(c.serverError,"error show")},a.errorCallback=function(){l.removeClass("show"),a.outputMessage(c.serverError,"error show")},a.hideList=function(){i.removeClass("show")},a.showList=function(){i.addClass("show")},a.focusHandler=function(){0!==s("ul > li",i).length&&a.showList()},a.outputMessage=function(s,r){h.removeClass("error show").addClass(r).html(s)},a.formClick=function(s){s.stopPropagation()},a.clickMoreButton=function(){s(t.searchFormClass,a).submit()},a.searchAjaxInstancer=new r.CherryAjaxHandler({handlerId:t.searchHandlerId,successCallback:a.successCallback,errorCallback:a.errorCallback}),s(t.inputClass,a).on("input",a.inputChangeHandler).on("focus",a.focusHandler),s(a).on("click"+t.searchFormWrapperClass,a.formClick).on("click"+t.searchFormWrapperClass,t.moreButton,a.clickMoreButton),s("body").on("click"+t.searchFormWrapperClass,a.hideList)}}(jQuery,window.CherryJsCore);